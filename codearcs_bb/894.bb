; ID: 894
; Author: skn3[ac]
; Date: 2004-01-23 15:30:09
; Title: Urlencode / Urldecode
; Description: Acts like the php counterparts

Dim urlencodearray$(255)
urlencodearray$(0)="%00"
urlencodearray$(1)="%01"
urlencodearray$(2)="%02"
urlencodearray$(3)="%03"
urlencodearray$(4)="%04"
urlencodearray$(5)="%05"
urlencodearray$(6)="%06"
urlencodearray$(7)="%07"
urlencodearray$(8)="%08"
urlencodearray$(9)="%09"
urlencodearray$(10)="%0A"
urlencodearray$(11)="%0B"
urlencodearray$(12)="%0C"
urlencodearray$(13)="%0D"
urlencodearray$(14)="%0E"
urlencodearray$(15)="%0F"
urlencodearray$(16)="%10"
urlencodearray$(17)="%11"
urlencodearray$(18)="%12"
urlencodearray$(19)="%13"
urlencodearray$(20)="%14"
urlencodearray$(21)="%15"
urlencodearray$(22)="%16"
urlencodearray$(23)="%17"
urlencodearray$(24)="%18"
urlencodearray$(25)="%19"
urlencodearray$(26)="%1A"
urlencodearray$(27)="%1B"
urlencodearray$(28)="%1C"
urlencodearray$(29)="%1D"
urlencodearray$(30)="%1E"
urlencodearray$(31)="%1F"
urlencodearray$(32)="+"
urlencodearray$(33)="%21"
urlencodearray$(34)="%22"
urlencodearray$(35)="%23"
urlencodearray$(36)="%24"
urlencodearray$(37)="%25"
urlencodearray$(38)="%26"
urlencodearray$(39)="%27"
urlencodearray$(40)="%28"
urlencodearray$(41)="%29"
urlencodearray$(42)="%2A"
urlencodearray$(43)="%2B"
urlencodearray$(44)="%2C"
urlencodearray$(45)="%2D"
urlencodearray$(46)="%2E"
urlencodearray$(47)="%2F"
urlencodearray$(48)="%30"
urlencodearray$(49)="%31"
urlencodearray$(50)="%32"
urlencodearray$(51)="%33"
urlencodearray$(52)="%34"
urlencodearray$(53)="%35"
urlencodearray$(54)="%36"
urlencodearray$(55)="%37"
urlencodearray$(56)="%38"
urlencodearray$(57)="%39"
urlencodearray$(58)="%3A"
urlencodearray$(59)="%3B"
urlencodearray$(60)="%3C"
urlencodearray$(61)="%3D"
urlencodearray$(62)="%3E"
urlencodearray$(63)="%3F"
urlencodearray$(64)="%40"
urlencodearray$(65)="%41"
urlencodearray$(66)="%42"
urlencodearray$(67)="%43"
urlencodearray$(68)="%44"
urlencodearray$(69)="%45"
urlencodearray$(70)="%46"
urlencodearray$(71)="%47"
urlencodearray$(72)="%48"
urlencodearray$(73)="%49"
urlencodearray$(74)="%4A"
urlencodearray$(75)="%4B"
urlencodearray$(76)="%4C"
urlencodearray$(77)="%4D"
urlencodearray$(78)="%4E"
urlencodearray$(79)="%4F"
urlencodearray$(80)="%50"
urlencodearray$(81)="%51"
urlencodearray$(82)="%52"
urlencodearray$(83)="%53"
urlencodearray$(84)="%54"
urlencodearray$(85)="%55"
urlencodearray$(86)="%56"
urlencodearray$(87)="%57"
urlencodearray$(88)="%58"
urlencodearray$(89)="%59"
urlencodearray$(90)="%5A"
urlencodearray$(91)="%5B"
urlencodearray$(92)="%5C"
urlencodearray$(93)="%5D"
urlencodearray$(94)="%5E"
urlencodearray$(95)="%5F"
urlencodearray$(96)="%60"
urlencodearray$(97)="%61"
urlencodearray$(98)="%62"
urlencodearray$(99)="%63"
urlencodearray$(100)="%64"
urlencodearray$(101)="%65"
urlencodearray$(102)="%66"
urlencodearray$(103)="%67"
urlencodearray$(104)="%68"
urlencodearray$(105)="%69"
urlencodearray$(106)="%6A"
urlencodearray$(107)="%6B"
urlencodearray$(108)="%6C"
urlencodearray$(109)="%6D"
urlencodearray$(110)="%6E"
urlencodearray$(111)="%6F"
urlencodearray$(112)="%70"
urlencodearray$(113)="%71"
urlencodearray$(114)="%72"
urlencodearray$(115)="%73"
urlencodearray$(116)="%74"
urlencodearray$(117)="%75"
urlencodearray$(118)="%76"
urlencodearray$(119)="%77"
urlencodearray$(120)="%78"
urlencodearray$(121)="%79"
urlencodearray$(122)="%7A"
urlencodearray$(123)="%7B"
urlencodearray$(124)="%7C"
urlencodearray$(125)="%7D"
urlencodearray$(126)="%7E"
urlencodearray$(127)="%7F"
urlencodearray$(128)="%80"
urlencodearray$(129)="%81"
urlencodearray$(130)="%82"
urlencodearray$(131)="%83"
urlencodearray$(132)="%84"
urlencodearray$(133)="%85"
urlencodearray$(134)="%86"
urlencodearray$(135)="%87"
urlencodearray$(136)="%88"
urlencodearray$(137)="%89"
urlencodearray$(138)="%8A"
urlencodearray$(139)="%8B"
urlencodearray$(140)="%8C"
urlencodearray$(141)="%8D"
urlencodearray$(142)="%8E"
urlencodearray$(143)="%8F"
urlencodearray$(144)="%90"
urlencodearray$(145)="%91"
urlencodearray$(146)="%92"
urlencodearray$(147)="%93"
urlencodearray$(148)="%94"
urlencodearray$(149)="%95"
urlencodearray$(150)="%96"
urlencodearray$(151)="%97"
urlencodearray$(152)="%98"
urlencodearray$(153)="%99"
urlencodearray$(154)="%9A"
urlencodearray$(155)="%9B"
urlencodearray$(156)="%9C"
urlencodearray$(157)="%9D"
urlencodearray$(158)="%9E"
urlencodearray$(159)="%9F"
urlencodearray$(160)="%A0"
urlencodearray$(161)="%A1"
urlencodearray$(162)="%A2"
urlencodearray$(163)="%A3"
urlencodearray$(164)="%A4"
urlencodearray$(165)="%A5"
urlencodearray$(166)="%A6"
urlencodearray$(167)="%A7"
urlencodearray$(168)="%A8"
urlencodearray$(169)="%A9"
urlencodearray$(170)="%AA"
urlencodearray$(171)="%AB"
urlencodearray$(172)="%AC"
urlencodearray$(173)="%AD"
urlencodearray$(174)="%AE"
urlencodearray$(175)="%AF"
urlencodearray$(176)="%B0"
urlencodearray$(177)="%B1"
urlencodearray$(178)="%B2"
urlencodearray$(179)="%B3"
urlencodearray$(180)="%B4"
urlencodearray$(181)="%B5"
urlencodearray$(182)="%B6"
urlencodearray$(183)="%B7"
urlencodearray$(184)="%B8"
urlencodearray$(185)="%B9"
urlencodearray$(186)="%BA"
urlencodearray$(187)="%BB"
urlencodearray$(188)="%BC"
urlencodearray$(189)="%BD"
urlencodearray$(190)="%BE"
urlencodearray$(191)="%BF"
urlencodearray$(192)="%C0"
urlencodearray$(193)="%C1"
urlencodearray$(194)="%C2"
urlencodearray$(195)="%C3"
urlencodearray$(196)="%C4"
urlencodearray$(197)="%C5"
urlencodearray$(198)="%C6"
urlencodearray$(199)="%C7"
urlencodearray$(200)="%C8"
urlencodearray$(201)="%C9"
urlencodearray$(202)="%CA"
urlencodearray$(203)="%CB"
urlencodearray$(204)="%CC"
urlencodearray$(205)="%CD"
urlencodearray$(206)="%CE"
urlencodearray$(207)="%CF"
urlencodearray$(208)="%D0"
urlencodearray$(209)="%D1"
urlencodearray$(210)="%D2"
urlencodearray$(211)="%D3"
urlencodearray$(212)="%D4"
urlencodearray$(213)="%D5"
urlencodearray$(214)="%D6"
urlencodearray$(215)="%D7"
urlencodearray$(216)="%D8"
urlencodearray$(217)="%D9"
urlencodearray$(218)="%DA"
urlencodearray$(219)="%DB"
urlencodearray$(220)="%DC"
urlencodearray$(221)="%DD"
urlencodearray$(222)="%DE"
urlencodearray$(223)="%DF"
urlencodearray$(224)="%E0"
urlencodearray$(225)="%E1"
urlencodearray$(226)="%E2"
urlencodearray$(227)="%E3"
urlencodearray$(228)="%E4"
urlencodearray$(229)="%E5"
urlencodearray$(230)="%E6"
urlencodearray$(231)="%E7"
urlencodearray$(232)="%E8"
urlencodearray$(233)="%E9"
urlencodearray$(234)="%EA"
urlencodearray$(235)="%EB"
urlencodearray$(236)="%EC"
urlencodearray$(237)="%ED"
urlencodearray$(238)="%EE"
urlencodearray$(239)="%EF"
urlencodearray$(240)="%F0"
urlencodearray$(241)="%F1"
urlencodearray$(242)="%F2"
urlencodearray$(243)="%F3"
urlencodearray$(244)="%F4"
urlencodearray$(245)="%F5"
urlencodearray$(246)="%F6"
urlencodearray$(247)="%F7"
urlencodearray$(248)="%F8"
urlencodearray$(249)="%F9"
urlencodearray$(250)="%FA"
urlencodearray$(251)="%FB"
urlencodearray$(252)="%FC"
urlencodearray$(253)="%FD"
urlencodearray$(254)="%FE"
urlencodearray$(255)="%FF"
Function urlencode$(url$)
	temp$ = ""
	For i=1 To Len(url$)
		ichr$ = Mid$(url$,i,1)
		iasc  = Asc(ichr$)
		If (iasc >= 48 And iasc <= 57) Or (iasc >= 65 And iasc <= 90) Or (iasc >= 97 And iasc <= 122) Or iasc=43 Or iasc=45 Or iasc=46 Or iasc=95
			temp$ = temp$ + ichr$
		Else
			temp$ = temp$ + urlencodearray$(Asc(ichr$))
		End If
	Next
	Return temp$
End Function
Function urldecode$(url$)
	url$ = Replace$(url$,"%20","+")
	For i=255 To 0 Step -1
		url$ = Replace$(url$,urlencodearray$(i),Chr$(i))
	Next
	Return url$
End Function
